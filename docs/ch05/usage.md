# 数据库的基本使用
此处主要为关系型数据库的使用。


### sql.DB
如果你想要操作数据库，首先需要获得一个`sql.DB`类型对象。需要注意的是，它并不是一个连接，
也没有特定于某个数据库或者模式，只是一个抽象的接口。它对应的数据库，可能是本地文件、通过网络访问、
内存或进程中数据库中的某一种。

它为你做了一些很重要的事情，比如下面这两个：   
* 通过驱动打开或关闭与数据库的链接
* 管理一个数据库连接池

通过`sql.DB`这个抽象对象，你可以不用太过担心与底层数据层面并发连接的问题。
当一个连接在使用的时候会进行标记，在完成之后会回收入连接池中。

如果数据库连接释放失败，将导致大量的连接产生且无法回收，并最终耗尽资源。

### sql.Driver
因为Go标准库只是提供了一个数据库的抽象，如果你想使用某一特定的数据库（如MySQL, Oracle等），就必须导入相应的驱动。   
一般来说，特定数据库的驱动会按照Go标准库`database/sql`规范来实现（但是可能会有一些细微的区别）。   
相应的，你也应该使用标准规范中的接口来编写代码，这样方便更换下层驱动，减少耦合。   

这里用MySQL数据库驱动`go-sql-driver/mysql`为例。使用方式如下：   
```go
import (
	"database/sql"
	_ "github.com/go-sql-driver/mysql"
)
```
通过引用而不直接使用的方式，我们可以使用该驱动来连接数据库同时使用标准库中的方法。

### 开始使用
要使用数据库，需要创建一个`sql.DB`对象，如下所示：
```go
db, err := sql.Open("mysql", "user:password@tcp(127.0.0.1:3306)/hello")
if err != nil {
	log.Fatal(err)
}
defer db.Close()
```
其中`sql.Open()`方法返回的是一个`*sql.DB`对象。
它的第一个参数是特定数据库类型名称，如**mysql**与**postgres**等。
第二个参数是如何连接相应数据库的方法。
在使用完成之后，记得使用`db.Close()`方法关闭链接，防止链接长期无法释放。



